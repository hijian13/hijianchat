<!DOCTYPE html>
<html>
<head>
  <title>HijianChat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body{
      font-family: Arial;
      background:#0f172a;
      color:white;
      margin:0;
      padding:20px;
    }

    h1{
      text-align:center;
      color:#00ffcc;
    }

    .container{
      max-width:500px;
      margin:auto;
    }

    textarea{
      width:100%;
      height:70px;
      border-radius:10px;
      border:none;
      padding:10px;
      font-size:16px;
    }

    button{
      margin-top:10px;
      padding:10px;
      width:100%;
      border:none;
      border-radius:10px;
      background:#00ffcc;
      font-weight:bold;
      cursor:pointer;
    }

    .post{
      background:#1e293b;
      padding:10px;
      border-radius:10px;
      margin-top:10px;
    }
  </style>
</head>

<body>

<h1>HijianChat</h1>

<div class="container">
  <textarea id="message" placeholder="Andika message..."></textarea>
  <button onclick="addPost()">Post</button>

  <div id="posts"></div>
</div>

<!-- Firebase SDK -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

 const firebaseConfig = {
  apiKey: "AIzaSyD_3SimPt5ekldlHFi4643ZeuTMyrhL6YU",
  authDomain: "hijianchat.firebaseapp.com",
  projectId: "hijianchat",
  storageBucket: "hijianchat.firebasestorage.app",
  messagingSenderId: "42011973323",
  appId: "1:42011973323:web:ceb35b05123397e7a56d4e"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.addPost = async function(){
  const message = document.getElementById("message").value;
  if(message === "") return;

  await addDoc(collection(db, "posts"), {
    text: message,
    createdAt: new Date()
  });

  document.getElementById("message").value = "";
}

const q = query(collection(db, "posts"), orderBy("createdAt", "desc"));

onSnapshot(q, (snapshot) => {
  const postsDiv = document.getElementById("posts");
  postsDiv.innerHTML = "";

  snapshot.forEach((doc) => {
    const div = document.createElement("div");
    div.className = "post";
    div.innerText = doc.data().text;
    postsDiv.appendChild(div);
  });
});

</script>

</body>
</html>
